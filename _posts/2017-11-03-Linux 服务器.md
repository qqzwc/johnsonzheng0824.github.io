---
layout: post
title: "Linux 服务器相关（持续更新）"
date: 2017-11-03
tag: [Linux, Redis] 
---   

## 快捷键
- Tab：命令和文件名补全；
- Ctrl+C：中断正在运行的程序；
- Ctrl+D：结束键盘输入（End Of File，EOF）

## 一般操作
- su 最高权限
- apt-get update 更新源
- apt-get upgrade 更新已安装的包

## Linux 的启动过程 / 关机

### 命令问题求助

- man 你不会的命令（常用）
    - **显示说明**    
    - NAME  命令的名称和单行描述
    - SYNOPSIS 怎样使用命令
    - DESCRIPTION 命令功能的深入讨论
    - EXAMPLES  怎样使用命令的例子
    - SEE ALSO  相关主题（通常是手册页）
- 具体命令 - -help
- info 具体命令（了解即可）

### Linux 系统有 7 个运行级别（RunLevel）：常用的是 3 和 5
- 运行级别0：系统停机状态，系统默认运行级别不能设为0，否则不能正常启动
- 运行级别1：单用户工作状态，root权限，用于系统维护，禁止远程登陆
- 运行级别2：多用户状态(没有NFS)，没有网络服务
- 运行级别3：完全的多用户状态(有NFS)，登陆后进入控制台命令行模式
- 运行级别4：系统未使用，保留
- 运行级别5：X11表示控制台，进入图形界面
- 运行级别6：系统正常关闭并重启，默认运行级别不能设为6，否则不能正常启动

### 启动过程
1. 内核引导
2. 运行 init（如 RunLevel）
3. 系统初始化
4. 建立终端
5. 用户登录

![](/images/posts/linux/Snipaste_2018-05-25_16-40-09.png)

### 关机
- **sync** 将数据由内存同步到硬盘中
- Shutdown –h now 立马关机
- Shutdown –r now 系统立马重启
- reboot 就是重启，等同于 shutdown –r now
- halt 关闭系统，等同于shutdown –h now 和 poweroff


## VI / VIM 编辑器

### 三种模式
1\. 一般模式
> 以 vi 打开一个档案就直接进入一般模式了(这是默认的模式)。在这个模式中， 你可以使用『上下左右』按键来移动光标，你可以使用『删除字符』或『删除整行』来处理档案内容， 也可以使用『复制、粘贴』来处理你的文件数据。

![](/images/posts/linux/Snipaste_2018-05-25_20-21-10.png)


2\. 插入模式
> 在一般模式中可以进行删除、复制、贴上等等的动作，但是却无法编辑文件内容的！ 要等到你按下『**i(常用)**, I, o, O, a, A, r, R』等任何一个字母之后才会进入编辑模式。<br>
注意了！通常在 Linux 中，按下这些按键时，在画面的左下方会出现『INSERT 或 REPLACE 』的字样，此时才可以进行编辑。而如果要回到一般模式时， 则必须要按下『Esc』这个按键即可退出编辑模式。

3\. 指令模式
> 在一般模式当中，输入『 : / ?』3个中的任何一个按钮，就可以将光标移动到最底下那一行。在这个模式当中， 可以提供你『搜寻资料』的动作，而读取、存盘、大量取代字符、离开 vi 、显示行号等的动作则是在此模式中达成的！

![](/images/posts/linux/Snipaste_2018-05-25_20-35-50.png)

### 总结

![](/images/posts/linux/180430082980605.png)

## 常用基本命令

### 1. 日期时间类
- date 时间
- cal 日历

### 2. 文件目录类
- pwd,显示目前的目录
- ls,列出目录的内容（ll 和 ls -l 一样）
    > 语法：ls [选项] [目录或是文件]<br>
  命令中主要选项的含义如下：<br>
  选项与参数：<br>
  -a ：全部的文件，连同隐藏档(开头为 . 的文件) 一起列出来(常用)<br>
  -d ：仅列出目录本身，而不是列出目录内的文件数据(常用)<br>
  -l ：长数据串列出，包含文件的属性与权限等等数据(常用)<br>
  每行列出的信息依次是： <br>
  文件类型与权限  链接数  文件属主  文件属组  文件大小用byte来表示  建立或最近修改的时间  名字<br>
  ls –R 递归查看目录
  
- mkdir, 创建一个新的目录
    - mkdir -p a/b/c, 可以自行帮你创建多层目录
- rmdir, 删除一个空的目录
- touch / vim 文件名, 新建文件
- cd, 切换目录
    ```
    #使用 mkdir 命令创建 atguigu 目录
    [root@www ~]# mkdir atguigu
    
    #使用绝对路径切换到 atguigu 目录
    [root@www ~]# cd /root/atguigu/
    
    #使用相对路径切换到 atguigu 目录（. 表示当前目录）
    [root@www ~]# cd ./atguigu/
    
    # 表示回到自己的家目录，亦即是 /root 这个目录
    [root@www atguigu]# cd ~
    
    # 表示去到目前的上一级目录，亦即是 /root 的上一级目录的意思
    [root@www ~]# cd ..
    ```
- cp, 复制文件或目录
- rm, 移除文件或目录
- mv, 移动文件与目录或修改名称
- cat, 由第一行开始显示文件内容
- tac, 从最后一行开始显示，可以看出 tac 是 cat 的倒写
- more, 一页一页的显示文件内容
    > 空白键(space)：代表向下翻一页<br>
  Enter：代表向下翻『一行』<br>
  q：代表立刻离开 more，不再显示该文件内容<br>
  b 或 [ctrl]-b：代表往回翻页，不过这动作只对文件有用，对管线无用
  
- less, 与 more 类似，但是比 more 支持的功能更多
    > 空白键：向下翻动一页<br>
  [pagedown]：向下翻动一页<br>
  [pageup]：向上翻动一页<br>
  /字串：向下搜寻『字串』的功能<br>
  ?字串：向上搜寻『字串』的功能<br>
  n：重复前一个搜寻 (与 / 或 ? 有关！)<br>
  N：反向的重复前一个搜寻 (与 / 或 ? 有关！)<br>
  q：离开 less 这个程序

- head, 只看头几行
- tail, 只看尾巴几行
  

### 3. 文件权限类

### 4. 网络配置类
- ifconfig

### 5. 磁盘分区类
1. 分区
    - fdisk -l, 查看linux有几个磁盘分区
        - ![](/images/posts/linux/Snipaste_2018-05-26_13-07-40.png)
        - s表示scsi硬盘
        - d表示disk
        - a表示第一块盘(a为基本盘(第一块硬盘，两块就会有b)，b为基本从属盘，c为辅助主盘，d为辅助从属盘)
        - 数字，前四个分区用1~4表示，它们是主分区或扩展分区，从5开始才是逻辑分区
        - 上面四个放在一块表示计算机里面第一块SCSI硬盘
        
    - 挂载/卸载概念(mount umount)
        - mount  [参数]  设备名称  落地挂载点目录
    > 对于Linux用户来讲，不论有几个分区，分别分给哪一个目录使用，它总归就是一个根目录、一个独立且唯一的文件结构Linux中每个分区都是用来组成整个文件系统的一部分，它在用一种叫做“挂载”的处理方法，它整个文件系统中包含了一整套的文件和目录，并将一个分区和一个目录联系起来，要载入的那个分区将使它的存储空间在这个目录下获得
        
2. 硬盘
    - df -h, 列出文件系统的整体磁盘使用量,检查文件系统的磁盘空间占用情况

### 6. 搜索查找类
- find, 查找文件或者目录
    > 命令：find + 搜索路径 + 参数 + 搜索关键字<br>
      按文件名：find /home/esop -name  't*'
      
- grep, 在文件内搜索字符串匹配的行并输出
    > grep + 参数 + 查找内容 + 源文件<br>
    －n：显示匹配行及 行号。

### 7. 进程线程类

![](/images/posts/linux/Snipaste_2018-05-26_17-17-40.png)

- **ps -aux**, 然后再利用一个管道符号导向到 grep 去查找特定的进程,然后再对特定的进程进行操作
    > 如 ps -aux(ef)&#124;grep redis 查看 redis 进程

- **ps -ef**, 是以全格式显示当前所有的进程

- kill 进程的 pid

- netstat

    ![](/images/posts/linux/Snipaste_2018-05-26_17-27-54.png)

### 8. 压缩和解压类

#### 一组
- gzip + 文件

    > 1 只能压缩文件不能压缩目录<br>
      2 不保留原来的文件
- gunzip + 文件.gz, 解压

#### **二组（重要）**
- 压缩：tar -zcvf  XXX.tar.gz   n1.txt    n2.txt

    > 参数：<br>
      -c 产生.tar打包文件<br>
      -v 显示详细信息<br>
      -f 指定压缩后的文件名<br>
      -z 打包同时压缩<br>
      -x 解包.tar文件
- 解压：tar -zxvf  XXX.tar.gz

#### 三组
- 压缩：zip mypackage.zip 1.txt 2.txt
- 解压：unzip mypackage.zip

- ### 静态网站部署
    - apt-get install apache2
    - service apache2 restart
    - 在 /etc/apache2/sites-available/000-default.conf 更改默认路径
    
- ### 安装 redis
    - yum install gcc-c++ 安装 gcc
    - cd /opt 进入 opt 文件夹
    - wget http://download.redis.io/releases/redis-4.0.9.tar.gz 下载
    - tar zxvf redis-4.0.9.tar.gz 解压
    - cd redis-4.0.9 进入解压好的文件夹
    - make 编译
    - make install 安装
    - cd /usr/local/bin 安装在了这个目录下
    > 在解压好的目录下 cd /opt/redis-4.0.9 有一个文件 redis.conf
    > 复制到新建文件夹 /myredis 下
    - mkdir myredis 新建文件夹
    - cp /opt/redis-4.0.9/redis.conf /myredis 完成复制
    - vim /myredis/redis.conf 
    > 将 daemonize no 改成 yes(必改)
    > 最新 redis 安装、配置、远程访问发现，需调整 redis.conf 参数有：
    > 1. bind 127.0.0.1 -> #bind 127.0.0.1 
    > 2. protected-mode yes -> protected-mode no<br>上述两个配置仅适用于开发环境，不建议在生产环境做上述配置。 
    
    > 进入 cd /usr/local/bin
    
    - redis-server /myredis/redis.conf 后台启动服务
    - redis-cli -p 6379
    > 至此可以用 ping 指令，如果返回 PONG 则说明成功
    - shutdown 关闭服务
    - ps -ef&#124;grep redis 查看 redis 进程
    
ps: 防火墙内要记得开放 redis 进程的端口
    
